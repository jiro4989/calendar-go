package calendar

import (
	"testing"
	"time"

	"github.com/stretchr/testify/assert"
)

func TestCalendarDays(t *testing.T) {
	tests := []struct {
		desc      string
		year      int
		month     time.Month
		want      [][3]int
		wantCount int
	}{
		{
			desc:  "ok: 2021/12/1",
			year:  2021,
			month: time.December,
			want: [][3]int{
				{2021, 11, 28},
				{2021, 11, 29},
				{2021, 11, 30},
				{2021, 12, 1},
				{2021, 12, 2},
				{2021, 12, 3},
				{2021, 12, 4},
				{2021, 12, 5},
				{2021, 12, 6},
				{2021, 12, 7},
				{2021, 12, 8},
				{2021, 12, 9},
				{2021, 12, 10},
				{2021, 12, 11},
				{2021, 12, 12},
				{2021, 12, 13},
				{2021, 12, 14},
				{2021, 12, 15},
				{2021, 12, 16},
				{2021, 12, 17},
				{2021, 12, 18},
				{2021, 12, 19},
				{2021, 12, 20},
				{2021, 12, 21},
				{2021, 12, 22},
				{2021, 12, 23},
				{2021, 12, 24},
				{2021, 12, 25},
				{2021, 12, 26},
				{2021, 12, 27},
				{2021, 12, 28},
				{2021, 12, 29},
				{2021, 12, 30},
				{2021, 12, 31},
				{2022, 1, 1},
			},
			wantCount: 35,
		},
		{
			desc:  "ok: 2022/1/1",
			year:  2022,
			month: time.January,
			want: [][3]int{
				{2021, 12, 26},
				{2021, 12, 27},
				{2021, 12, 28},
				{2021, 12, 29},
				{2021, 12, 30},
				{2021, 12, 31},
				{2022, 1, 1},
				{2022, 1, 2},
				{2022, 1, 3},
				{2022, 1, 4},
				{2022, 1, 5},
				{2022, 1, 6},
				{2022, 1, 7},
				{2022, 1, 8},
				{2022, 1, 9},
				{2022, 1, 10},
				{2022, 1, 11},
				{2022, 1, 12},
				{2022, 1, 13},
				{2022, 1, 14},
				{2022, 1, 15},
				{2022, 1, 16},
				{2022, 1, 17},
				{2022, 1, 18},
				{2022, 1, 19},
				{2022, 1, 20},
				{2022, 1, 21},
				{2022, 1, 22},
				{2022, 1, 23},
				{2022, 1, 24},
				{2022, 1, 25},
				{2022, 1, 26},
				{2022, 1, 27},
				{2022, 1, 28},
				{2022, 1, 29},
				{2022, 1, 30},
				{2022, 1, 31},
				{2022, 2, 1},
				{2022, 2, 2},
				{2022, 2, 3},
				{2022, 2, 4},
				{2022, 2, 5},
			},
			wantCount: 42,
		},
	}

	for _, tt := range tests {
		t.Run(tt.desc, func(t *testing.T) {
			assert := assert.New(t)
			got := CalendarDays(tt.year, tt.month)

			assert.Len(got, tt.wantCount)
			for i, want := range tt.want {
				assert.Equal(want[0], got[i].Year())
				assert.Equal(want[1], int(got[i].Month()))
				assert.Equal(want[2], got[i].Day())
			}
		})
	}
}
